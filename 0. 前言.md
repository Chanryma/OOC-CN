#### 前言

没有一种编程技术能解决所有问题。

没有一种编程语言只产生正确的结果。

编程人员不应该每个项目都从头开始。

面向对象编程是当前的一剂万能药——虽然该它已经出现了十几年。本质上，比起我们被教了 20 多年的编程规范，它并没有什么不同。C++（Eiffel，Oberon-2，Smalltalk 等）是*新语言*，因为它是面向对象的——虽然你要是不想（或不知道）按面向对象的方式用它也行，并且只是用 ANSI-C 也能够实现这些。只有面向对象的方式能实现在不同项目里实现代码的复用——就算子程序的这个概念已经和电脑本身一样老，并且编程人员总是随身带着各种工具包和库。

这本书的目的不是赞扬面向对象编程或贬低*旧方法*的。我们只是用 ANSI-C 来探索面向对象编程是怎么实现的、它的技术是什么、它为什么能帮我们解决更大的问题、以及我们如何掌控一般性和程序以便能更早地捕捉错误。在这个过程中我们会碰到所有的术语，包括类、继承、实例、链接、方法、对象、多态等等，以及更多，我们将会看到怎么用我们早就知道的内容实现这些高深的技术。

有趣的是，我发现 ANSI-C 其实是一种全面的面向对象语言。若要弄明白它是如何做到的，你需要对 ANSI-C 非常熟悉，你必须熟悉结构体、指针、原型和函数指针。在书中，你会碰到所有的新话——根据 Orwell 和 Webster 的说法，它是一种[「用来减少思考范围的」](http://artcontext.org/remote/newspeak.html)的语言。我会尽量演示如何把所有那些你一直想要的好的编程原则形成一个体系。最后，你可能会变成一个更精通 ANSI-C 的编程人员。

前六章用 ANSI-C 构建了面向对象的基础。我们从抽象数据类型的信息隐藏技术开始，到基于动态链接添加泛型函数，然后通过小心仔细地扩展结构体的长度来实现继承。最后，我们用这些技术一起构建了类的继承关系，让代码维护起来更容易。

编程需要有规则。良好的编程要有许多规则，非常多的规则，以及标准的、防御性的措施来把事情做对。编程人员会使用一些工具。好的编程人员会做一些工具使得在处理日常工作时一劳永逸。用 ANSI-C 来面向对象编程要求大量的不可变的代码——命名可以改变，但结构不能。因此，在第七章我们构建了一个小的预处理器来制作需要的样板。它看起来像是一种新的面向对象的方言（叫它 yanoodl？），但我们不能这么看待它——它去除了笨拙的部分，让我们能够集中精力用更好的技术处理问题的有创造性的部分。OOC（不好意思）适应性很好：我们创造了它，我们理解并能修改它，它像我们平时一样用 ANSI-C 编写代码。

我们在接下来的章节里改善我们的技术。在第八章我们增加了动态类型检查来在早期捕捉到的我们的错误。在第九章我们安排了自动初始化来防止另一类 bug。第十章引入了代理并展示了类和回调函数一起协作简化了类似于生产标准主程序时带来的无尽的麻烦这样的事情。更多的章节是关于使用类方法解决内存泄露，用一致的方式存储和加载结构化的数据，以及通过使用一套嵌套的异常处理实现的规范的错误恢复机制。

最后，在最后一章我们走出 ANSI-C，实现了必修的用鼠标操作的计算器，先为诅咒，再为 X Window 系统。这个例子清晰的展示了我们用对象和类能多么方便地来做设计和实现，虽然我们需要在使用外部的库和类的层级关系时处理一些特定的问题。

每一章都有一个总结，我在总结里给比较粗心的读者概要的描述下这一章讲的内容和它们对后续工作的重要性。大部分章节都有些练习，不过并没有正式地提出来，因为我认为你应该主动去练习。由于我们是从头构建这些技术，我尽量忍住不去使用大量的类库，虽然他们会对一些例子有帮助。如果你想理解面向对象编程，有一点很重要，就是你要先掌握技术然后在设计的时候考虑你的选项，稍晚一点再考虑在开发时用别人的库。

本书很重要的一部分是附带的软盘，它有一个 DOS 文件系统，包含了一个独立的 shell 脚本用来创建按章节分好的所有源代码。还有一个 ReadMe 文件——在你 make 之前，看一下它。还有一件事很有好处，就是你用一个 diff 之类的工具在后续的章节里跟踪主要的类和 OOC 报告的演进过程。
这里讲的技术来自我掌握的 C++ 的知识，那时我需要面向对象的技术来实现一个交互的编程语言，我发现我忘不了 C++ 里的一个轻便的实现。我选择了 ANSI-C，我能完美地做我必须做的事。我在课程和工作室里向许多人展示了这些内容，有人已经用这些方法完成了他们的工作。若不是 Brian Kernighan 和我的出版商 Hans-Joachim Niclas 和 John Wait 鼓励我把这些内容出版（在这个过程中重新发明了一遍），我就只是把它当做自己曾经的爱好而已。感谢他们，也感谢那些在本书制作过程中帮助过、忍受过的人们。最后，感谢我的家人——不，面向对象替代不了切片面包。<div style="text-align: right">霍拉格，1993 年 10 月</div>
<div style="text-align: right">Axel-Tobias Schreiner</div>



